# Cave Story DLL Mod Template
This project contains a skeleton that can be used to create a
"modloader"-style DLL for freeware Cave Story modding.
It works by spoofing dinput.dll to inject additional functionality
into the game upon startup.

Unlike [Clownacy's mod loader](https://github.com/Clownacy/Cave-Story-Mod-Loader),
this project produces a completely standalone DLL that requires
no additional files or dependencies. Thus, this project eschews the "plug and play"
approach of Clownacy's mod loader in favor of a much lighter, simpler design
which still aims to be fairly modular at the code level.

As far as I am aware, these two mod loader projects *should* be compatible with
each other, but I have not tested this myself to confirm.

## Build Instructions

### Microsoft Visual Studio (recommended)
Project files for Visual Studio 2019 are included in the repo—everything should
be set up to work straight out of the box.

### MSYS2 (MinGW 32-bit)
You must use the MinGW 32-bit environment of MSYS2 to build this project.
(The 64-bit environment gives linker errors when building, for some reason.)
You will also need to install GCC and make if they are not already installed.
You can install both of them at once by typing `pacman -S mingw-w64-i686-gcc make`
in your terminal.

Once those are installed, simply type `make` from the top-level directory and it
should produce a `dinput.dll` output file in the `bin` folder.
You can also type `make debug` to compile with debug symbols enabled, or
`make clean` to delete all files generated by the compiler.

## Usage Instructions

`patches.cpp` is where all of the action begins—you can either write your patches
directly inside this file, or create separate `*.cpp`/`*.h` files in the `patches`
folder which you can then `#include` inside `patches.cpp`. (The latter approach is
recommended as it will make it easier to share your hacks with others.)

Functions for modifying the game can be found in `patch_utils.h`, and vanilla
functions and variables can be accessed by `#include`-ing the relevant header(s)
in the `doukutsu` folder.

All of the other files in the top-level directory generally don't need to be touched,
unless you know what you're doing.
